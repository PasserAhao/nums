<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>展示数字</title>
</head>
<body>
<div style="width: 100vw">
    <div id="numberDisplay" style="width: 16rem;color: #a72e58;margin: 45vh auto;font-size: 100px">计算中...
    </div>
</div>
<script>
    let c = 0.03;
    let datas = [
        [2073, "2024-04-24 00:00:00"],
    ]

    // 计算今年的总天数
    const oneDay = 24 * 60 * 60 * 1000; // 一天的毫秒数
    const getdaysByYear = () => {
        const startOfYear = new Date(new Date().getFullYear(), 0, 1);
        const endOfYear = new Date(new Date().getFullYear() + 1, 0, 1);
        return Math.round((endOfYear - startOfYear) / oneDay)
    }
    days = getdaysByYear()
    const getResult = (num, s, e) => {
        const day = (e - s) / oneDay
        return num + ((num * c) / days) * day
    }
    let total = 0;
    let last_date = null;
    let is_init = true

    function getNowTotal() {
        let date = null
        if (is_init) {
            for (let data of datas) {
                const num = data[0];
                date = new  Date(data[1])
                if (last_date === null) {
                    last_date = date
                    total = num
                    continue
                }
                total = getResult(total, last_date, date) + num;
                console.log(`${date.toLocaleString()} ${num > 0 ? "存入" : "取出"}${num} \n余额: ${total}`)
            }
            is_init = false
        } else {
            date = new Date()
            total = getResult(total, last_date, date)
        }
        last_date = date;
        document.getElementById('numberDisplay').innerText = total.toFixed(6);
    }

    getNowTotal()
    // 每秒更新一次displayValue的值
    setInterval(getNowTotal, 1000);
</script>
</body>
</html>
